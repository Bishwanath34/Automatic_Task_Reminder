<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Task List</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
</head>
<body class="p-4">

<h1 style="
  border-radius: 8px;
  border: 1px solid transparent;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  padding: 5px;
">Task List</h1>

<a href="/api/" class="btn btn-primary mb-3">Add Items</a>
<form th:action="@{/api/tasks}" method="get">
<label>Status:</label>
<select name="status">
    <option value="">All</option>
    <option value="PENDING">Pending</option>
    <option value="IN_PROGRESS">In-progress</option>
    <option value="COMPLETED">Completed</option>

</select>
<label>Priority:</label>
<select name="priority">
    <option value="">All</option>
    <option value="LOW">Low</option>
    <option value="MEDIUM">Medium</option>
    <option value="HIGH">High</option>

</select>
<label>Search Title:</label>

    <input type="text" name="keyword" placeholder="keyword...">
    <button type="submit" class="btn btn-primary mb-3">
        Filter
    </button>


<a th:href="@{/api/tasks?pageNo=0&pageSize=5}">Clear Filters</a>
<label>Sort:</label>
<a th:href="@{/api/tasks(sortBy='dueDate')}">Due Date</a> |
<a th:href="@{/api/tasks(sortBy='priority')}">Priority</a> |
<a th:href="@{/api/tasks(sortBy='title')}">Title</a>
</form>
<div class="table-responsive">
    <table class="table table-striped table-hover table-bordered align-middle">
        <thead class="table-dark">
        <tr>
            <th>Id</th>
            <th>Title</th>
            <th>Description</th>
            <th>Due Date</th>
            <th>Priority</th>
            <th>Status</th>
            <th>Created At</th>
            <th>Actions</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="task : ${tasks}">
            <td th:text="${task.id}"></td>
            <td th:text="${task.title}"></td>
            <td th:text="${task.description}"></td>
            <td th:text="${task.dueDate}"></td>
            <td th:text="${task.priority}"></td>
            <td th:text="${task.status}"></td>
            <td th:text="${task.createdAt}"></td>

            <td>
                <div style="align-items:center;display:flex;justify-content:center;gap:10px">
                    <a th:href="@{/api/form/{id}(id=${task.id})}" class="btn btn-sm btn-warning">Edit</a>
                    <a th:href="@{/api/task/{id}(id=${task.id})}" class="btn btn-sm btn-danger ms-1">Delete</a>
                    <a th:href="@{/api/taskUpdate/{id}(id=${task.id})}" class="btn btn-sm btn-success ms-1" >Mark as done</a>
                </div>

            </td>
        </tr>
        </tbody>
    </table>
</div>
<nav aria-label="Page navigation example">
    <ul class="pagination">
        <li class="page-item" th:classappend="${currentPage==0} ? 'disabled' ">
            <a class="page-link" th:href="@{/api/tasks(pageNo=${currentPage-1},pageSize=${pageSize}, sortBy=${param.sortBy},
                   status=${param.status},
                   priority=${param.priority},
                   keyword=${param.keyword})}">Previous</a></li>
        <li class="page-item" th:each="i:${#numbers.sequence(0,totalPages-1)}" th:classappend="${i==currentPage} ? 'active' "><a class="page-link" th:href="@{/api/tasks(pageNo=${i},pageSize=${pageSize}, sortBy=${param.sortBy},
                   status=${param.status},
                   priority=${param.priority},
                   keyword=${param.keyword})}" th:text="${i+1}"></a></li>
<!--        <li class="page-item"><a class="page-link" href="#">2</a></li>-->
<!--        <li class="page-item"><a class="page-link" href="#">3</a></li>-->
        <li class="page-item" th:classappend="${currentPage==totalPages-1}?'disabled' "><a class="page-link" th:href="@{/api/tasks(pageNo=${currentPage+1},pageSize=${pageSize}, sortBy=${param.sortBy},
                   status=${param.status},
                   priority=${param.priority},
                   keyword=${param.keyword})}">Next</a></li>
    </ul>
</nav>

<footer class="footer">
    Task Reminder App Â© 2025 - Created by Bishwanath Kumam
</footer>
</body>
</html>
